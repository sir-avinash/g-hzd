function [y1] = nnEquZero0_raw040817(x1)
%NNEQUZERO0_RAW040817 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Aug-2017 01:37:15.
% 
% [y1] = nnEquZero0_raw040817(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 3xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3];
x1_step2.xoffset = [-2.15697005862333;-2.71508961902427;0];
x1_step2.gain = [0.463613296810547;0.36831196767618;1.02564102564103];
x1_step2.ymin = -1;

% Layer 1
b1 = [3.5129117242443613;0.60462689448119777;3.4299680376832433;2.2075354568410641;-0.63480898043006961;2.6368098023018862;1.693753193254081;7.1438602666950262;-0.19231917119139147;2.5487310226008328;-2.8124432390676435;11.02929173444058;4.3138410212289671;6.8660521934563992;-4.2267824632308475;-1.2356653732775529;-6.2937831080659405;-8.6825873490631533;-4.005553099548143;-6.9545328205373256;0.89890267728635975;-6.6327796339575364;-3.8486347541208308;-2.262464997826426;-0.60077498122537554;11.710767300327733;5.2569291939627991;-0.70767542189560528;-6.7152015612248181;8.0216408064656193;1.6600895999613217;-3.1708974975376272;-4.1517489436185668;2.4543435437610972;1.2276809712237078;0.70655269383687236;-2.1541015411944024;5.4250919988337394;-0.67987803848770101;-0.67443025530122847;-1.9471636690416514;0.70339719312892823;3.4627523778705434;-0.80862319869268473;-2.5462573494061127;-0.78642655992277588;-0.030373157500067513;-4.067677167835086;-1.4171699689616128;-5.091182754515609];
IW1_1 = [1.7212209163250685 0.76389273010220704 0.48635598314235168;0.25700317488159879 0.80381299374985515 -0.47363604984903762;-1.5114762642082464 -1.1357729952718401 -3.3291710656075271;-0.60674546921680339 -0.77933337946831793 2.0521881876873787;0.32155572644122843 0.42477138129826325 1.1746302475725938;0.19995803488117897 1.5499774667011057 1.4043172506734725;0.76849116531864048 0.90787516762643627 -2.4889717041775272;-1.0034064295170275 -1.3394462414438304 4.7417181417808978;0.87838258059437135 0.016449702228920785 0.64964013916123509;0.16584498123778912 0.44026670337124157 2.5926763111870086;0.15919312937498981 1.6983981102531751 2.4177050814967491;-0.027089739751698774 -0.044525286509419296 11.870438067770161;-0.36364476837182114 -0.61750094599034633 -4.315321069858423;0.27257127437596385 0.21795692963813432 6.160338185856074;-0.60149844302351807 -0.70894313873396808 5.1896505896035272;1.5133867776559615 0.37588624925272801 0.30980712351729089;-0.74059952317131916 -1.0279658463092856 -4.8383581753276355;0.037691110368606326 0.032961510210950395 -9.0163882696985915;-0.5894362062313464 -0.81551321139198518 4.8074428755663998;-3.0348264961276508 -2.9921257132010415 5.7369683887836667;0.41546972833420676 1.9325386273291847 -0.50541163968066205;-0.46224429486134128 -0.44326543182375688 -5.9756604727720859;0.66892246459192495 1.1404376136862207 4.1341832577246267;0.55603188661109493 0.59249649944424665 -1.8953388566551734;0.2707788299999237 0.22509555029095027 1.7079769633676305;-0.006383281195970196 -0.0062570037473642587 12.688687389054479;-0.58378797185456277 -1.2798320056014454 3.6087964250860978;0.71198117061745092 0.5626451530019636 -0.6044926229085239;0.96304262435552868 1.8466662099545965 -3.6354256040026907;0.029727227920713709 0.12075907115390665 8.2018201609902768;0.95940818181325949 0.93989297830327811 -1.8618388056635347;1.6230027197183918 1.3402186776495724 3.2226529406831586;-0.31365653521839371 -0.46972137721491886 4.1429012149353204;-0.04756028617190932 -0.057807444349765938 2.628990017524361;-1.1375294828806479 -0.47211015309597254 -0.15011610021279928;0.85452109574884538 0.52994112724705433 1.0286035872628396;0.29460562658735484 0.2632987252897564 -2.2390202312338641;-0.20768140074160402 -0.45573733060522692 6.0675411791586757;0.34192581294877772 0.76644481688670807 0.79067776358854858;-0.8532848899751565 0.15675037776627268 -0.70140687165323268;-0.42443022363889388 -0.74013049933115305 1.3372331216458027;-0.59511883274967303 -0.547957025022908 -0.11057209863013817;-0.97857136106550224 -1.0189440835225967 2.7841986022762213;-0.5070129676495827 -0.55793092740370775 0.79684641877468798;-0.25692860223747144 -0.64180365348762369 -2.4203275386186092;0.33274660524381056 0.94419290452992843 0.47460936366512074;-0.49762752242766228 0.054653364065815981 -0.30868376583502039;-3.9941483313219428 -2.2109412392914214 2.4794955224799655;-1.2183568421039428 -0.76641186705736353 1.1592211315275882;0.24636231567789876 0.47403903388685192 -5.5954901191517612];

% Layer 2
b2 = [-2.1792519780270885;-0.72560483368043394;1.5343117738668441];
LW2_1 = [0.76006347493216109 -2.8988792245540411 1.3943314273289873 -3.0232196758761183 -4.9957009417805862 0.27194806146355516 -0.86992287076917807 -5.2379318146350791 1.4974628691377745 -0.66005195048322785 0.2532578042846283 8.3767632203423048 -6.8216225649355469 9.7515160020834575 -1.0790652577291182 0.51434713735397908 -1.3847689173310929 8.9440913176514236 2.1825211538958627 -0.65667784290955422 0.16569663020268693 5.0446993339814759 -2.1573387528954791 -10.148599031974886 1.2799833349329079 -4.9340328325418437 -2.3248349421065435 -0.041568708130441202 -5.9075129196860816 4.0803752538520142 3.2870218055216185 0.7471914775668147 -5.8770903386232813 4.4356166458006703 1.235046133813678 0.35548637671900968 6.8909420646867146 3.4283188561678481 6.3189029851367184 -0.88124840101365398 7.743062645349565 -1.9806269785526156 -1.1199542333432961 -3.1057099343179604 -0.11810387993425493 -4.7518283319847416 4.8810555141136671 0.13988226204945531 1.8609437446553065 4.3173460382515527;-2.4026182626904582 1.8535493249315618 -1.2666555587170598 -0.52325869178042761 2.7832598211145485 -0.28612810366184815 1.2668893610362413 0.52032504729918594 -1.4348671535688455 -1.4920746714614199 0.074597382112038008 -0.089292413184525909 5.7062929520604921 0.1660992192108468 0.46899916447863976 -1.0396872635016028 -0.18174000304861399 -0.55302082197806945 -1.392120447486392 0.60964249324184905 -0.078598433256947875 0.3354201614870343 2.113659463179701 -0.45942267650148266 -0.82799794342871413 -0.0065021025164218003 -0.45954127966984359 0.67008031158964032 -0.71965300308431901 -0.48060406368682518 -3.9098323295605706 -0.78311833709792167 4.1270746846954562 -0.33521353124548037 -3.2335579657556295 0.1220024293193441 -1.5184136773469485 -0.20620564417263071 -0.99417098466401854 0.75614180413745513 -5.1375734250168463 2.5805235495360823 0.042023235562265115 1.4754502938346763 -0.81760138350854461 1.3784716374464936 -2.8734085711666784 -0.27271595567450935 -2.5144074413792201 -0.34644746115890263;3.2625547869353149 2.5566177086834783 2.3227447113810404 3.1934952139280051 -7.1226431518503937 -0.14708597234288637 -2.130767759358438 4.5026175576559346 -0.097236865647872928 8.0937693564840369 -0.2347277771678094 -0.43350020880437096 -5.9719704123534587 -5.3350721850739484 -2.2633126459700463 1.2737688836448171 1.4348953334406425 1.360262047108258 4.5294686237765411 -0.61460002733220531 -0.076868114583786881 -3.2660977388909624 -5.0302068319836195 7.0156155143662753 2.3840749082989734 0.28572206836034353 3.4903739913091538 -2.5910164690177373 6.5266521607655266 2.1719220939706805 5.1428720269464874 1.8861084102790902 -2.0635166364100765 -5.80982160187743 3.7647250293218288 -0.48187485474662689 -2.305663435854767 -2.4565224860852082 0.5893673679158189 0.042676434877482662 3.4937381189691425 -4.7317852324751666 0.97490695894883761 2.7113088478161931 4.611507381235481 1.3314740287692162 -2.8558064350077124 0.32462078722097981 2.0519560949196367 -2.97260147097129];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0797103421043416;2.92966549136895;0.854797863617639];
y1_step1.xoffset = [-12.5454235121835;-0.341335897543965;-1.16986721956445];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
