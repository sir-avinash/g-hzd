function [y1] = nnControllerProjectionReducedGrid2(x1)
%NNCONTROLLERPROJECTIONREDUCEDGRID2 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 23-Jul-2017 20:48:08.
% 
% [y1] = nnControllerProjectionReducedGrid2(x1) takes these arguments:
%   x = 3xQ matrix, input #1
% and returns:
%   y = 3xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-2.72641231479001;-2;0];
x1_step1.gain = [0.369114317061882;0.5;1.0126582278481];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.69908825537681751;1.7126339150684275;-0.18268456318101647;-2.8545873307787426;0.15984555598301223;2.7473350536052235;-17.128699415030205;3.0696963792658001;-0.19638123271948346;0.68014839486034773;-2.2343168370824302;-0.36514200725569468;-0.56213803557748265;0.88081606155649383;-3.3960192012274661;-0.75884935427824918;-5.8880339522727656;11.951151527207065;-5.0185264705970818;-5.5587542138889905;-2.6050461639424016;0.92178638987222028;-0.21076296440773112;1.0557292374623291;-0.41813502358960064;0.21319041065177652;0.65055738402777052;0.92994966303396331;-1.733845771422903;0.50108971629775434;-2.7190860649819482;12.286382371131598;0.093698222732423522;0.41608496942022372;-17.122331170053208;-10.502075418645548;6.0637761156840915;-0.51457472233772195;3.0101830456691836;-2.7828403958702355;2.6343072396465104;10.199451367816401;5.3012978300483038;1.1456596387115598;-1.6507509224857582;0.65101655433237948;2.4384748089934738;-1.9334986966391319;-6.7151462225934289;4.6876408414633781];
IW1_1 = [-0.60235138172929359 -0.86509645761815901 -0.587819027965924;-0.29908292711700812 -0.40832449767389006 -2.3565531798246155;-0.3658778000760487 -0.5900207327161423 2.063190517275129;-0.21973523632749301 -0.46234033167462824 2.9392261787579352;-0.29329695372701414 -0.10299865971734713 -0.35910879697135667;-0.044508891151551391 -0.086715292089710544 2.9859341141554907;-0.081013312329216311 -0.17268779520067012 -17.621795797361901;-0.22445588751453588 -0.64957180642214474 1.7965509066925172;-0.47029260861380418 -0.5038519820461268 0.42211338833227707;-0.40007179595203052 -0.46141575246715005 0.48423262492231134;0.35693409187605663 0.10506186328463324 2.2195287628934275;-0.26517540819373475 -0.39517875982963169 0.91038504059062064;0.018424381212697225 -1.266204724891328 0.64906670316275694;-0.216214275191532 -0.6389423795326733 0.43130838897619722;0.41226772892845659 1.6364013582017847 0.32914926059123778;0.56274618109137375 0.5750528712655365 -0.22749332474155026;0.20159834603195681 0.24253496536456992 5.4248418550253872;-0.050633782514699292 -0.10750120139691756 12.698316745412086;0.059809808954922036 0.12030280773593907 -5.4148782104982649;-0.11158652039245924 -0.24103486466159688 -4.830759511600883;-0.076427102573518743 -0.13451687705516652 -3.4735600638228665;0.25195742654902292 0.42863041979946193 -1.9554057801888711;0.095796001251672841 0.18028567219406613 2.0038693791933806;0.071894165054017842 0.11926218400429636 -2.122498520346308;-0.55154064116685542 -0.71685108780188889 0.22338004190761915;-0.060373246064367787 -0.1107083969272003 -1.2872711677052422;-0.29617682994551187 -0.43086624938611601 -1.299924236929547;0.1915165201870298 0.30323173934058256 -1.3736671104298148;0.62979633368019905 0.97721477853885308 0.85245549918120311;-0.066434628567105053 1.5393194683823261 -0.88740132224818058;-0.20562877377184335 -0.25333425013609989 2.7490199080683082;0.051111887964422273 0.10720322263540702 13.117342577014599;-0.49846790941899422 -0.71853636021065148 -0.16739791581638244;0.26585611074106386 -0.41879752595335468 -0.24704297938621425;0.08084631959503201 0.17125676696598174 -17.617005150414933;0.061894827699685732 0.12969216420770238 -10.651325451226821;0.24877796078455408 0.28987976467769655 -5.644864638029067;-0.052624702187434577 -0.46604471414194282 0.71460853896046261;-0.29467054989418423 -0.29537959471605379 -3.2862892844011049;-0.37764709344564512 -0.39238802509944753 2.0713345545414903;-0.035551207281376396 -0.068616564319121165 3.2864843703743718;0.063140857613915941 0.13318130388011029 10.26502890141156;0.46287483002551533 0.66668913692173659 -4.2271219636716753;0.47539042522282454 0.85822985996630474 -0.51074992618950055;-0.070367674253159623 0.38401554012877775 -0.63058165198262073;-0.082355933629994188 0.514395326503854 -0.14081486893418402;0.18037556914468572 0.3608984127743618 2.2560612742539772;0.60607345026838677 0.6333680945066521 -0.33748476884249462;0.55650224892183664 0.74179700964098805 5.4162612895085189;0.053657157586728593 0.1063260584281201 5.1102875404425339];

% Layer 2
b2 = [0.12348342643766476;0.13627583223564979;0.87159836563538462];
LW2_1 = [-1.277132462873543 1.6598395736986635 -0.19866671290063115 -0.81214700161058118 1.0386247596554579 -4.1902164569566098 2.2952885032377353 2.0465126266572562 1.100754127705152 1.4983710906481538 0.40046395948291486 2.5579634825679745 -0.13796375955804577 1.6640795326989457 -2.5529167949433189 -0.19203528886245402 -1.974489063898802 3.3863659710559539 2.3230065244137976 7.1201416190695452 -0.65022822757460508 1.4184317818734677 0.71761470483728662 -0.5976384541837102 -1.1070216289604555 4.031825773354921 1.6070328291095186 -4.348374376692866 3.0316271801721029 -0.035322175504062268 2.9385660554124247 -2.5110544876272676 -1.7030960011123557 0.17116404866762672 -2.2002575598636338 11.592686130939978 -1.6718853621929732 0.78882657949825941 1.2919138632692797 -2.0052892509280524 1.0227161362021548 13.220083064623779 4.0292275022019295 1.436624825521774 1.1173579763094601 -0.82565323248646971 -0.87328306651587484 -1.4183774000874467 3.0162658608735282 4.3373383086954309;0.17024014250317374 -0.56837451256595284 0.0096449625098390477 1.3699056166937094 -0.62842984487658238 1.1213170747632322 -0.19028690760289269 -0.41072727282501992 0.0028088815669431296 -0.79837113500660117 0.69625820779777403 -2.0301509292724829 0.091492462789786788 -0.71223170190640572 0.25876184729323509 -0.28527182867712847 -1.4201421978159661 -0.21805743896316968 -0.9814391925830106 -0.30078129878640658 0.073259978473787526 -1.6322769180125929 -0.43117614095788875 0.5192440113940644 0.19553861007467616 -3.0236281626452639 -0.29742933447395031 3.5213947827315648 -0.67144163495782394 0.059558910940130931 0.44645678781706721 0.12050051690108596 0.49237082366234824 -0.12140340709158856 0.19646012324797177 -1.1150814567761587 -1.0926530115361215 -0.85615053861613422 0.8834916044802541 -0.75970785377008077 -0.16293835904418641 -1.1727861153951176 0.48684998233884413 -0.62797358963427674 -0.44554826232890848 0.19439294429546913 -0.40054508569040953 0.11312263676174525 1.0518595891499154 -1.2536076909639433;-0.61605573065843044 1.2943898014746176 0.40425195284658971 2.0478680668630012 -0.75217761169617114 -1.7300694733495825 -0.22292120129648046 0.33480886802847992 1.3464921686312603 -0.011228180112987082 2.2305602030950857 -1.0900227829908229 -0.73921375417786817 -0.2558963030701828 -1.3776726165710416 -0.99284889142962107 -4.5637945520751355 -0.81835441694739519 2.756923245215499 4.2079446613609264 -2.5666472635689592 -2.4134456160875661 -0.95427570135075523 1.907456325797209 -0.49988956076473123 -0.5399864585688634 0.63386653095035261 -0.23927766975623035 1.3459191564116801 -0.32686735180775356 3.0619845840926589 0.4172389969472578 -0.57799044496699925 -0.15793616368677788 0.51125270745191453 -2.0308760331016025 -3.485915553279916 -0.27442895894466246 3.6759650510562674 -0.42836463463666774 -2.6960085561798071 -0.12633993659150755 6.6335320562435625 0.32413478250463901 -0.77748739511952958 -0.92660137502643136 -0.81394083551646812 -1.3912010062616924 5.425398406736976 4.5253334479595093];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.165259013399426;4.78621318932395;1.84583974034306];
y1_step1.xoffset = [-6.0807058259274;-0.217465033577691;-0.552285862759673];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
