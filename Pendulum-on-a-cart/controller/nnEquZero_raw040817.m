function [y1] = nnEquZero_raw040817(x1)
%NNEQUZERO_RAW040817 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Aug-2017 00:58:56.
% 
% [y1] = nnEquZero_raw040817(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 3xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3];
x1_step2.xoffset = [-2.15697005862333;-2.71508961902427;0];
x1_step2.gain = [0.463613296810547;0.36831196767618;1.02564102564103];
x1_step2.ymin = -1;

% Layer 1
b1 = [-4.3299349374957945;1.9844104376004279;4.3422094950102137;-7.4531503679246844;-0.79400619244754278;0.62967027914353735;-4.5081621719733498;-0.69242487661084839;-0.5857509482459915;-0.66277358943712372;2.8140561925029672;10.857288488590676;-2.7818624104500334;9.2126365362500025;5.0526281308937353;6.5978047565539732;0.34332391836719461;0.081761143215114157;-6.8933702726034838;-9.9845209706432456;-1.5180885653251146;0.5061258787302263;-0.61519215992850795;0.6836145438308997;-1.3291541567762941;-0.72741344217959925;-1.3602579421111529;4.3756626232661109;-4.006109324603802;-2.5253139064020038;-0.61989169126689525;6.9675646717127808;-9.753620241348079;1.0838482687039959;4.630387206308713;-1.2032495145944329;-1.1681190093756901;12.848213208914109;0.66702596836529093;5.6594252134544094;1.1967986428087647;1.2293018310322967;-1.752959422124559;-2.1539076602620417;4.6297908603783036;2.1437612221047542;-0.67606449304172711;-1.53465965397575;0.62487250948741735;-0.79509196803734283];
IW1_1 = [0.2028877531306264 0.37511710095980216 -4.9773840216669765;0.54255695268193815 0.94604201340529215 0.63020066849391077;0.47897024031389884 0.85525366572455275 -4.4693056117773615;0.55908923216050099 0.73306702650232369 -5.3263433192268641;-0.10248129348219735 -1.0396650813312778 0.11461208486756762;0.88713440432888879 0.16185243276025207 -0.54997690042767844;0.15508502897279083 0.29235613038131109 -5.5403625193260257;0.28146441342340395 0.30776254690119825 -1.2717230832608679;-0.49881604456937773 -0.99731215101221427 0.24618295466697948;1.1192819707290029 -0.12499171957904348 0.036772407361395983;-0.96844586500205065 -1.4592252966562107 -3.0049523416641666;-0.36360735778370007 -0.60177174516653575 9.0391099797413883;1.0112554687813819 1.5001889883508039 3.2494873838547171;0.5928307869354974 0.86606254623407231 7.1938039881158176;-0.87804585448189731 -1.5499589757683501 -5.3289613342951165;0.18819478015919622 0.20578187380888346 7.1738517833838049;0.88597396875922385 0.92196264357227631 1.2717744978037395;0.19378092685173096 0.11751683800837084 0.90066560743052482;0.23069616632581186 0.50695167393357854 -7.8871757646682727;-0.080334714430226106 -0.03941488865630275 -10.670248416923448;-0.71447263417425178 -0.30198312578551256 -0.95283735015336712;0.0056700479075741791 -0.91625879960756329 -0.26815286974628333;-0.91453992955192376 -0.306527235913092 1.0923538510851496;1.0370477896501591 0.65287572617964262 -1.6817499271852903;-0.059287606326623006 0.040674479197303069 -1.4577181235039696;-1.1623348754141498 -0.93154293848585723 2.0611074899373127;-1.2780185740689327 -0.44804191013873573 0.11867966529039546;-0.89666733177429403 -1.1975254423593484 -4.0338365202536224;-0.7836371696324661 -1.3747159389965389 4.4665108902989239;1.5887743927809166 1.1450482540265317 2.8253806329659246;-0.89608013632383265 -0.85263710898580236 0.71369965544021419;0.15431703016598375 0.1622882901751454 7.8210018450632024;-0.011144909586917039 0.078027045245721904 -10.455483340452307;-0.1333860933121403 -0.048778978031585242 1.4900980678972775;-0.11109224946821755 -0.20253987908336743 5.8149876959735645;-0.34930056909620444 -0.48214874269519548 -1.7559926658019411;-0.44931122850122457 -0.59008438564383159 -1.5324109450300525;0.32070235620764825 0.60512384585242418 11.182072664019181;1.1087822513121315 -0.14869855029915074 -0.18738659844947497;0.047452768974783191 -0.075588745618734271 -5.8490327493825429;0.11217207371132602 0.34837884761506016 2.0179787072387971;0.64081080430556514 0.68089363152976556 1.5583359815850546;1.2603565609529392 0.90429547507462005 -0.36272924009276936;-0.97824765909019173 -1.0815595921460675 -1.1083416857195598;4.3776179349607611 3.9820480396587379 -4.4680643707515229;-1.3237165279182226 -0.77101705889193084 -1.8871839649432052;0.53801058724770834 0.51246377965841272 0.41434104492062429;0.80928372550834138 0.5289053351699412 -0.67054492134217458;0.61751767531744606 0.81656521684401562 -0.59613734076493574;-0.41475821318336881 -0.77888777178360125 0.7809249741535883];

% Layer 2
b2 = [0.68098232409447568;-0.35391399735990181;-0.1955153767413457];
LW2_1 = [4.8710470777730821 3.5111389557396375 4.3162586993159922 8.423754684798622 1.1280670306637963 -2.7567833122113119 -6.8721526333876453 -2.9089052416219543 -2.4720297326469485 0.24356602185947249 3.4908084751478476 0.82618188135752013 1.681908059413354 9.113930781100624 -0.51865688433279267 6.3346476250477401 0.70843723091641975 -5.4560714367635281 -0.74915885670127302 5.7160622484278081 2.0205208242278565 0.41233061246926384 -2.1840097242310281 -1.7796999598758783 -5.627348826753142 -0.64776165489160054 -0.33767060244473518 -2.669023520996276 1.6590119208508938 0.45717820569044776 -2.9457046506630444 -4.7334995967206686 -4.9653277180164883 -6.9147182216303715 -3.7790608622726345 7.4602937372435285 -4.9536910314106564 -6.1706971929637104 0.65182565853442853 -0.97011811168441775 2.2563039061763228 1.3479161531537465 1.172813952008706 -0.30804977804848088 -0.048875823207319258 1.3895690470238511 4.9326440564317302 -5.8004191331577939 -8.4834087391893416 -1.3265324632594258;-1.0570422853952242 -2.9373206387513955 -3.5509513439313212 -2.276784546356903 1.1915468236545064 2.3131985272022093 1.1085759417707104 2.2877152843984518 0.4672005301221685 -1.1586329975056899 -3.3175075556937945 -0.93028044593617154 -1.674870727894904 1.0660589927838622 0.60188839875793976 -0.31884948634875165 0.011854842826764874 3.6162566245020602 0.1241578954658077 -0.3045153879019562 0.10751391045634104 0.95121192731620319 1.8089427378638117 1.6202623598666606 0.55057546909347643 0.64496159577823242 -0.47767793676930459 2.2875440729220498 -1.2820252935475513 -0.42167795071054276 2.9407504300655782 0.23982520111815994 0.30595960738581579 1.4816710652371656 0.51443500395058195 1.2511917511499977 3.9702942972913702 -0.16852532813947621 -1.4948124441083301 0.74090548960144842 1.6199863850694747 3.0205427977808736 0.60556944920774303 -1.0161946019142649 0.022021623179337202 -1.2393373150231228 0.21668468696767867 0.71551298455101475 4.084305391889278 -2.7769365466301852;-1.6730895226321003 2.2224313079609526 5.2314208834598661 3.3293111771650139 -2.2327959813353013 -2.0635408805231132 2.4998919730386988 -2.3010504108497178 0.49395922952232418 1.1392186428341424 -0.77410546311503681 6.9298257181011422 -1.5358725152233947 -2.822212847722219 2.0046549117968659 -2.1943516314893903 -0.37164506219345605 -2.2363563087178426 0.23152426833129219 -1.4739820649564774 -1.3695281834850441 -1.8998072140737714 -4.1893698711342262 -4.7074089778442554 1.4466611396896785 -1.8517573291978366 0.52887867133193489 -1.8398186388553599 3.1555577440260145 0.92925532932706045 -1.7474206924825888 1.5977056456299106 1.2339712789231962 0.34004572916612835 1.3301117937375555 -4.5198843776240967 -2.3888481278662894 -1.3635533973702085 1.2742734031765668 -2.8701066467762759 -2.4646632006617297 -4.1963866269574543 -0.75339943484551541 1.517669630768097 -0.0085325787260654932 1.4394359761250766 -1.9282257742096069 1.902468308402155 0.3208686837349623 3.8995654001918441];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0797103421043416;2.92966549136895;0.854797863617639];
y1_step1.xoffset = [-12.5454235121835;-0.341335897543965;-1.16986721956445];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
