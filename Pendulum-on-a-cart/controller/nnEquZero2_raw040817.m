function [y1] = nnEquZero2_raw040817(x1)
%NNEQUZERO2_RAW040817 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 04-Aug-2017 01:14:30.
% 
% [y1] = nnEquZero2_raw040817(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3];
x1_step2.xoffset = [-1.52486008070235;-2;0];
x1_step2.gain = [0.655797874608537;0.5;1.02564102564103];
x1_step2.ymin = -1;

% Layer 1
b1 = [0.73480247199882087;0.68298404472326391;-8.86033978752263;2.9997635659436042;5.7050190483450143;-2.6989135350977187;-1.3071260670165048;-9.2982949210730794;3.4520346341923767;-0.12315547067048535;5.675460405813979;-1.4766062583893;1.6303497634574586;0.27650899080543762;1.4464532236485335;0.65834924703135067;0.012531588624266142;1.4271349140253446;-0.17884314390387165;1.0413318906424811;4.3644751724554496;0.50326430956724155;1.3846963692283878;6.5661494584647686;-3.0068314059590158;1.3006497151072083;-8.4721817145736811;-5.5984459134408429;-0.29103768730842933;1.1208780770153541;1.4469881331725261;-2.1451139938697792;0.54854851138903982;-7.0731183194208542;-6.7064425790456514;10.683767156975907;0.22304800144833564;3.0399882623032575;-3.1701219445786744;1.1827946137275387;-1.0837096667634416;-1.9325231596528885;0.15622082097729317;-0.29605619329158228;0.33640001156642152;-1.3986018592543694;0.41761194860231438;-0.23408383193363452;-1.261588082643964;5.9582160252616347];
IW1_1 = [-0.9320739304868807 0.79697314570763644 -0.40955479885395835;-0.20132528261867347 1.2517800334059379 -0.39674623756308597;0.39983727683012982 0.36656773008883564 -8.71028582149121;0.90186143763505011 -5.1644768998557842 0.32311726530772999;0.17122035731015819 0.14712096783285009 6.1432978113168373;-0.42574243624446845 1.1209600697505344 0.55059052302254019;-1.146153927218365 -1.3644623410736563 1.6233136039823772;-0.48587242350729959 -0.49481712957192681 -9.1284012880910108;-0.69150281507534339 -0.63837606606836295 2.7424681437403136;-0.74614761971159016 -0.74411355968350323 1.5671034918239759;0.36285665528224437 0.27252160395989811 6.0710241999699788;0.67043729609664104 0.70937008654385447 2.0676981830001333;1.6794345152499026 0.045629750104401741 -0.59816323506621849;1.6374257250110364 -1.7073810860354093 -0.033772307052602493;1.4902390659444069 0.29387883476379256 -0.56373877267226036;0.18065206108538401 -0.4512557861775407 -0.67126051460696456;-0.50773334704228557 0.51994308227185748 0.17463243858061292;0.56529446051216592 0.57842426056106255 -1.0668955148437085;-1.4348340827928507 1.4244477562714231 -0.32099906672889317;0.52054544894293819 0.83182689216115646 0.71605940849113703;2.9051862048443264 2.641605640607934 -2.7764313808743823;-0.38812064239879429 1.7089918351652711 -0.59833923666590938;1.018568433605985 0.92655456642858758 1.7751895090502909;-0.40881401126569611 -0.24655637079294651 7.3329190920556693;-0.9596988261695768 5.0752128369121854 -0.3711076735379551;-0.72215724730558573 -0.44676636216001242 2.0452648771818716;0.47929521519311702 0.38664954453046402 -8.4592236094342397;0.34284776840761927 0.39501361913433614 -4.5194031318069889;-1.6508004657431896 1.810011646491928 0.071403029219600248;-0.30839013375285185 -0.20774394055929868 1.9054650388200562;-0.4921715149621157 -0.41953436281938017 -2.0021958115709619;2.074584720728609 0.5828175644535909 0.068300143870374377;-0.71390580976351081 0.39411572013783325 -0.23546974408327392;-0.5969569827256751 -0.61669353122461756 -6.6737738971403449;4.739702658631284 4.3129511542301211 4.1909672448337369;0.58871541714671238 0.54610003596599888 10.686077692621145;1.5592050788787326 -1.5281447722572015 0.16138963475207257;1.0122465352191621 -5.0536986675686357 0.41463186161412563;-1.8512939701188622 -1.761283243282098 2.5684023124455764;0.63000072244000294 0.61539583288246591 1.6225262030399992;-0.14920132484856677 -0.1885036349633876 -1.6775947572316179;-0.2724835734905533 2.0452021838058112 0.20980357483311995;0.19943402256754092 -1.1563915637214979 -0.14582424015012799;0.97029222752169852 -0.32132488605427245 0.32568587637992297;-0.68685968037700429 0.014447801148208999 0.48504189604784131;-1.973891170710274 1.5590787797028289 0.75438914118486622;-0.31101960832852771 1.3187176146845252 -0.46665124038390421;-0.1855837510366051 2.0373287200904544 -0.33295779439818601;0.96388221255426021 0.55983934091201881 -1.7786613177946111;-0.15848242191361475 -0.10051671718079924 6.4655967637164204];

% Layer 2
b2 = -0.9545654474520151;
LW2_1 = [1.1414490936192634 1.6681021364516244 7.2371628397641645 1.6993903610524153 12.341452482204192 1.2368796599977316 1.200157194720068 -6.403341712984516 2.4962713061115345 0.78333025986846638 -5.1434339683575168 -1.9269592899845904 -1.9744437911659567 -2.7756602172241451 2.6621547583526577 1.2178645560684989 2.8864857476051551 3.8808623404927522 1.8030687070637939 -0.80178623285135886 3.0768974642310076 1.2095334598306504 -0.76545385157959678 2.0690975717881832 4.075842953086485 -1.9273976892689353 -5.0008620683389369 -2.6412067129618784 -1.4406188003766844 4.4402707749980506 -2.4059218045338659 0.30471572026896554 0.50035415260269256 3.3095188772211537 4.7895913781548645 -1.8237190837516999 2.7140752187405748 2.3254576966897007 1.6032872067415367 3.5221425606161643 6.0124469631668171 0.075379867044606155 1.0990090772004588 1.3582612127971621 -2.1445337816464707 0.070355225975225089 -3.6725224488386004 0.42261020419052381 -0.92606616966819322 -10.206450091043177];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0380826569707977;
y1_step1.xoffset = -26.2586720450417;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
