function [y1] = nnEquZero_raw020817(x1)
%NNEQUZERO_RAW020817 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 02-Aug-2017 23:59:55.
% 
% [y1] = nnEquZero_raw020817(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 2xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3];
x1_step2.xoffset = [-1.79350840416899;-2;0];
x1_step2.gain = [0.557566386461033;0.5;1.02564102564103];
x1_step2.ymin = -1;

% Layer 1
b1 = [1.6906315080619256;0.15226007239611017;0.88932051531477219;-3.3343075234363564;-0.87324728652141859;-0.14629847739438998;2.8809450699810037;-0.10922488542701882;-0.67695302986545469;-0.23501948805655187;-3.3497862471802691;3.7515113992759561;-0.0073086552688704674;-3.7590546711481538;-1.2639754464003037;1.2601601038354255;-0.79322506890057132;0.74745473320035538;-0.64720027315055551;-0.78924724307089544;-0.21278955061124141;0.71141345754436192;-4.3043497027922211;3.5245265939648047;-1.836952631752051;-2.3523651955614615;-2.7060151871604936;-1.1512910626422421;0.50265057842839789;0.2000184439484653;-0.30166053394383791;-0.62859847278659853;-0.2605919089845295;1.5835305905779438;1.4188050064179512;1.872941025648077;0.55652757175078726;-0.10927123825521906;0.46517327058418911;-1.174957749033797;-2.3026369929369417;0.72050405733917622;2.8341518109548511;0.51900921512110709;1.5957683609431306;-0.7440574381733509;2.1389262597552379;0.81432910454281549;-0.9140191338187863;0.00083285015688210409];
IW1_1 = [-1.5333831018435178 -0.41875836038936026 1.1378889385656967;2.6398294976029701 -0.064818204019198328 -0.27231331016706256;0.64981162635211187 0.38148305525685738 -1.1238107319701223;-2.6090989005794936 0.1243366258321817 -0.16715554333998467;0.38959431344776047 2.79807935242038 0.58893300401720672;-0.33900768603420695 2.8928394262613377 -0.058547292572477115;3.3440864013334992 -0.47403332562317207 0.19071786045231867;-0.50157841524879743 -0.16521719414776637 0.92582210533669151;0.34648106932030609 -0.11892573434191372 1.4413404137822863;-1.3701805401680034 -0.089273764267201128 0.27085294180538977;3.5035295666284512 0.16473466162337008 -0.94597562066006968;2.989152728471705 -2.3389297203802655 -0.28553168794992301;0.68123967031435917 0.23075215194032442 -1.0745498207399777;1.5832530662969142 5.6134536972985334 1.4563487018149031;-1.3410732799923624 -1.2360275588640213 0.58815155934455021;2.8239040614317594 1.4260698237976048 -0.73999326425527556;0.40587502621251992 -0.1802896901849611 0.41903083275711683;-0.73958911183698517 -2.5814525728540558 -0.83466393936035466;1.3508332992439498 0.9481876921898158 -0.96262427261921735;1.2823648374094423 -0.095818926369740445 0.038154443815895139;-0.25363837800414973 2.3177247164314783 -0.34864219273262176;-1.7855743637004469 -1.1559663647011562 -0.63663690022901087;-1.4604720882383129 -2.5492507593083835 -2.0286651109992295;-3.9616292948165883 -0.16104051136442407 0.87275904673439342;0.80774057423825063 -0.41176884600935137 -1.451713500897017;-0.62069438633814078 -0.54452062722990346 2.0850248855505895;-3.0865012456565548 -0.26570085969471913 -0.5869657483317744;0.98279601954039619 -2.4191130131922609 1.0262301046461306;1.5593822194925331 0.089136379105771393 0.18070751673072644;1.3172582744984727 0.96484472618838601 -0.61897754351012368;-0.13012415337443567 -0.059961511050972555 -1.2345521700304083;0.37644611613164447 -0.21970752720624898 1.2262947069744059;0.60870360596165962 -0.4937087716412929 1.1511302229088316;-1.2212152885775054 -0.31721809510627497 -0.43804858422037718;0.58557603266814806 -0.88879946409081645 1.6482334137563317;0.827954233091303 -0.84812480469884433 2.4923606690290088;1.0103829834368123 2.1624671849305841 -0.46341034599918685;-1.0660101514803864 -1.1507585852776274 -0.56420587005388012;-0.55535989143692288 -1.5460615607383914 0.65970599889755888;-0.33294992093169679 -0.89098995351959176 -0.85966521406837115;2.5603710974662315 -0.81586462027510764 -0.097232996263255378;0.85357530952830774 2.3808202348080898 -0.70981374320361623;-1.2606114561430628 2.4379337087285711 0.022276379428164423;-0.94673074920892719 -2.2124067477098381 -0.60148803029440778;-0.68454487278138842 1.3153087906581822 0.70154234308029828;-0.24082630805312055 0.84965808518204222 -0.29130269748296383;-0.43371866592586478 -0.25860455400400306 -1.8975333371548639;-0.16624787012904835 1.9780036274077422 0.4073042787577163;0.40766597902173835 -1.7192566439427994 -0.77580858791145257;1.3184068699952691 0.55345929802456983 0.36692768514334267];

% Layer 2
b2 = [-0.68456871274113262;-0.035488397995353346];
LW2_1 = [-1.5286648852959788 0.17393455215482673 0.53544726974528734 -2.9746433330791353 -0.26678847990238846 -0.57633336857723705 -1.0075691488473304 -2.0123597287202086 -0.01790124926218865 1.7446440909277652 2.653351511362299 0.47292943541033139 -0.45732484662761347 -0.097804190161908194 -0.66321691892715517 0.077405774147284723 1.3871982505859712 -0.28726887988933253 1.115700758255439 -3.0052655607236454 1.0821504571470222 -0.16823600219225376 0.10730332302734744 1.7744005491380472 -1.4163293200512468 -0.16459926088726878 -0.11418175620764001 -0.16242694994847931 -0.70666205253419156 1.3336483976575391 -1.2652909522857372 1.3912905171254437 -0.79927572475112085 -2.6232440133848223 -0.84815211945377722 0.23700297429066292 -0.33397920581278373 -0.74297931865371114 1.0510607128846357 -1.4370481055333557 -1.0749812273278612 -0.038659392379427907 -0.93560746308147302 0.28882684670219205 -1.3806676045549575 -1.664233103690826 -0.15266696157012963 -0.62116288975137868 0.069535483479245666 -0.034908233585769069;2.510638901759636 -0.65707802989125186 -3.5490507645129701 -0.28970427406834837 1.996536686980692 1.1571581368294663 1.5716390865499168 1.2545181591051329 -2.5764523597743341 -5.9832301179540517 -0.84749984519387223 -0.99061532304466005 -1.2251262301810275 0.62322061375704907 -1.4353355297691621 -0.35812054526388593 0.23569696836159379 2.3462689514338431 -1.664554757658687 0.66608611220801817 -2.3320775215912741 0.4128147681191196 -0.60359361144620771 0.052362259713214454 3.0180274502836748 2.6081958709760822 1.7082306822858777 0.44072900477134797 -1.2895721149952606 -2.5068018548432791 3.4084166917157974 -1.0767431594151142 1.8709265310509189 -1.7382430666974982 1.907343482070015 -0.50147661747645689 2.3930311925582415 2.2962260371554013 -1.2846112897471247 1.2307031324778939 1.7325037544435518 -1.4497817331828704 1.504930597840386 -2.0743938841958633 2.1868727720813665 1.2843510990452953 4.3170470120833668 2.6118044575361639 1.0400026613587539 1.7833143384051657];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [4.02576489533011;2.40414672927303];
y1_step1.xoffset = [-0.2484;-0.415947990122204];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
