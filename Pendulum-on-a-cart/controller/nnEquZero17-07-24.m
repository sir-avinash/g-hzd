function [y1] = nnEquZero17-07-24(x1)
%NNEQUZERO17-07-24 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 26-Jul-2017 15:41:58.
% 
% [y1] = nnEquZero17-07-24(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 3xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3];
x1_step2.xoffset = [-2.3844406503916;-2;0];
x1_step2.gain = [0.419385569456623;0.5;1];
x1_step2.ymin = -1;

% Layer 1
b1 = [-3.3667978316190679;1.4746112458785023;0.075444259013461731;1.1199182690489939;-0.50702083502427941;2.1646804695514605;2.753252839199126;-0.074446154494228742;0.066799622747738263;-0.49666842152730617;-3.4863950821316174;-2.6620823617444;-1.1685552749365149;-0.062248288674240503;-2.8617276111159407;-0.83708882494489256;3.6365605358053061;0.015452810691060271;0.77017247366517272;0.30734192161890705;9.0805589444455599;10.607641111693223;-9.9765184062070542;6.8510447224766331;0.49700457937203379;-2.9380833748377273;2.3282985021543752;3.0806291032205464;1.5717023402336123;-3.0837226206191137;0.28472735900642088;-6.7375061337735049;0.54400498909067951;0.13355454126831842;1.1208743115839344;-1.4923999008107558;-10.762266533878948;-4.5078202922034052;-7.9878915732161229;0.3270004420520975;-0.00037000431300709491;-1.1844898527980401;0.22399157287973961;-0.26117226730080284;0.49504140435336225;0.0057804430964913389;11.117217622036797;-0.24890331485726364;0.54341324726452944;-9.205887895482606];
IW1_1 = [0.29182513330446769 0.47779491516680062 3.7410040839892167;-0.16253281262438474 -0.62375022546892001 -2.0183306615572025;-0.28384302601442452 -0.12552912899493318 0.60539980551575101;-0.053639700657253445 -0.039422674445758935 -1.1861038094015848;0.036736312650739775 0.14230912835658815 0.33068300318767951;0.30784355575453137 0.23550600475497871 -1.3536892601617354;0.11568234126579068 0.25940730019925928 -3.9853976629151919;-0.094838157557243938 -0.36505078678136499 -1.5561397549446536;-0.37898785231869403 -0.61503276544466956 0.25090402977120224;0.049506839658485804 0.1753080031342146 0.33055548572685889;-0.043889783547350077 -0.10764552960401777 -3.9098699633115128;-0.21875206435671907 -0.34023509129930929 3.0441079342686419;0.22766033799441371 0.43921169023928608 -1.3414047955551964;0.16021248382070785 0.37702490389250731 0.96131319461353815;0.4865993008003705 0.7938398397648051 2.4656886058220859;0.35993394871979867 0.68536738630038152 0.76207297673246932;-0.019689972154850348 -0.03241137238289362 4.3489323497990773;-0.03413333971936252 -0.22266570444727818 0.80471988645203951;0.32301655591309075 0.59721643937535429 -0.85232967277572891;0.29106721802147539 0.60834216725770074 -0.0064738409006334921;-0.30163520850734976 -0.44306455460264887 -9.4309323549337076;-0.29917354993393253 -0.43749482406265705 -11.292009781154448;-0.046177709815000675 -0.11225111882211244 -10.578731012024212;-0.056307815730577866 -0.12715592100166481 7.5248179250794962;0.30338727597425202 0.48198465392644796 0.37206893051258899;-0.046599513448385733 -0.23307257636414558 4.3665811427941668;-0.41150882441247782 -1.2430235900371096 0.24524240395965438;-0.073064108304316533 -0.12612405349940231 3.3086133836933946;-0.11162358660964126 -0.20396809950674688 1.7360841118510213;0.14554397339580896 -0.15101117356438426 2.5219364461452574;-0.098460230003948032 -0.3933872627209723 -0.38531512470600326;0.052223347804920224 0.11924222601482985 -6.8951198465847838;0.095114574291385978 -0.14819550898342904 -0.93417133401970165;0.31120441562186762 -0.11280339729409385 -0.30241805523548321;-0.25683676200567312 -0.28958751727251036 -1.6637203947961248;0.14965467465362431 0.25050787641748617 -2.0684523994894124;-0.30849080807328777 -0.47196862897834868 11.477540731711034;0.13368514952686639 0.33083319083895013 -3.7680076745246947;-0.051314833488154077 -0.12123154332781495 -8.1183834167253668;0.03308327860283828 -0.12472180027553262 -0.384566015343344;-0.028431380132074715 0.28101158028759432 0.1440204056853398;-0.49343652157963064 -0.89550601502168881 0.68946835075812951;-0.10689931378747333 -0.01683571243579899 0.11561190076761217;0.26758799372886921 0.53600655211487058 0.40706250216853357;-0.060698396566041445 -0.20578668419128601 -0.31874496339982061;0.35783932077869157 0.36000560333802345 -0.12923064941971713;-0.059230706701026356 -0.13661656039822057 11.898376418942803;-0.10798144330782539 -0.11504287374653167 0.24306894297743281;-0.49607252451832295 -0.86051054316945141 0.69252583833651105;-0.30173903301828819 -0.45372997353117711 9.5786386983225285];

% Layer 2
b2 = [0.0092519772475748979;-0.023865263106979354;-0.8526730789544622];
LW2_1 = [2.3067448850526522 0.23289311616584943 -0.44749653688866631 -5.337280166121273 0.07758612162326961 -2.0749764470066765 -1.4509595223246041 -0.11272540671439217 0.73915768142456695 0.081582681939083537 -2.0275299516567307 -3.1123106326506971 -0.12569398944515134 -0.95103818304853827 -2.3747649453391513 -0.62760071734701306 0.15562932243542593 -0.15316321744084041 1.4630753105803169 -1.0546719759607335 -6.0122379505637236 3.0481457704035346 2.8647494357626817 2.3894149477169995 0.77145591025913751 -0.73883091413346169 -0.19142305786219715 -3.3417888008971786 3.0907693282717239 -2.037474585216966 0.006691963822987027 10.597825243438564 0.55315376576616127 -0.16026872756260757 0.92462741803046578 1.2852332784814349 2.6685741516334516 -1.7565515528127056 -8.346114301725013 0.086576567100260945 0.44973214161208874 1.387771391955114 -0.91997521238601043 -0.04937869512589009 -0.13272639244933521 -0.60722115799543286 1.5802501476084088 -0.43459439110177978 -0.21348738408643317 -5.1820106031027748;-1.2003651131442157 0.060348452060487903 0.33324017176326964 1.240056200125998 -0.060426998249829146 0.51242884134110633 1.1930001041263214 -0.23421400116520524 -0.15034836189829881 0.0037071827837007491 2.0492637972072472 1.9691165704015308 -0.074287850747107198 0.22724855262468127 0.019837484645893882 0.6119832685425991 0.51036709808129899 -0.58820696716880272 1.3704556745263423 0.11175959445711776 1.56575658909752 -0.90023088798023565 -0.35742752188411203 -0.26758888731783187 0.11535146864738655 0.69046223894122138 0.12717171741820008 1.7244798292598811 -0.49966041550626378 1.1981329102750711 -0.26692213269637988 -1.7635214328972877 -0.23395627682185163 0.067830234970454539 -0.66523901695418564 -0.12917279787497038 -0.76096557437186629 0.20249549750251503 1.339598082617639 0.095395417802211099 -0.33282792449892512 0.1688461214124222 0.19613825882970962 0.27342150003354254 -0.040394260601109906 0.06215973648807116 -0.21702883590285818 0.038924815155792235 -0.094844982130248515 1.2695664174558552;-2.1411589071266199 2.3535098512699757 0.31629303497691752 -0.82949180055948146 0.95475340203134362 0.068004224670734637 -0.34883183326846673 1.3815010255320517 0.56114938862047181 0.97637484391863771 -5.5265591129334641 2.2512878570740313 -1.9153076046466397 -1.6652763977105165 1.2825469461178984 0.60421028057671333 -3.7907716723990186 0.57756016877614436 -1.6640683338791979 0.35379587642145427 -1.8951213010252279 1.4704284269233967 -2.0583565105275978 -0.85782992486335141 1.0466378795939775 -0.36336887038182064 -0.15320668933342263 -0.4976369537828691 -0.33288186791649638 0.18689738993719812 -0.96785619466665018 -0.83003569502782248 -0.74723281722395063 0.30605117790662761 0.54772973821368764 1.6840516848351466 1.6577939352542723 -4.6699019103549873 3.5750005570783285 -0.85266457893472569 0.11051371322842943 -0.58427071352684712 0.29546339176033992 0.99815186435583358 -0.97391813927438475 0.24198475462183305 -0.79622740885024645 0.60213413191601883 -0.10475961003756919 -2.2949859918977098];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.180961323306447;4.52511094062482;1.75427169008349];
y1_step1.xoffset = [-5.52604270198975;-0.220989057090812;-0.570037130310418];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
