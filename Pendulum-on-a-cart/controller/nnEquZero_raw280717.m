function [y1] = nnEquZero_raw280717(x1)
%NNEQUZERO_RAW280717 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 28-Jul-2017 15:07:38.
% 
% [y1] = nnEquZero_raw280717(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 3xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [1 2 3];
x1_step2.xoffset = [-1.96514498541069;-2;0];
x1_step2.gain = [0.50886830611687;0.5;1.02564102564103];
x1_step2.ymin = -1;

% Layer 1
b1 = [-2.5893768970692035;-5.1508233708467488;2.1827362474226977;-1.7821424238405887;0.47871271242056646;0.17012064735909319;0.80814553536853639;0.18981384028402987;2.0571391345380872;10.27990641623561;-0.32608491692542535;-0.10460096372749271;7.9158290446443278;-0.5390208811846352;-2.2989255117554532;0.20263475807707834;2.0682984793231114;-0.23173419655290656;-10.573125032207686;-2.4816686373076546;-0.82352209887310313;0.10234840807540943;-4.9573129622798362;-3.5941024086735665;0.71406545895737927;-0.59687141413666989;0.52067831022074418;0.56425984972625021;0.30322234090069361;-1.2663572915103913;-0.072671767219853314;-0.49925006449253723;-8.1233361813342864;-5.2580904350993585;0.070546004145968871;0.28602595058206237;0.51498882261862144;-8.5274089122038248;1.1727868723490336;0.34007514573123337;2.0748152898491568;0.43400483106089061;0.32161166337366071;1.2957681026819856;-0.33814097057543741;2.6345012886394028;-0.35238763692202441;0.6143340396103768;0.16637224170645182;-1.6514962737022241];
IW1_1 = [-0.233310661828387 -0.60181894373300426 2.805492079858356;-0.034338172090132894 -0.074376370031055017 -5.9749058649557956;-0.056986438145033687 -0.14644177809177009 2.5272309914677344;0.2020753911949906 0.41654381823373032 2.302929653744719;0.12127582516472893 0.35464598349017828 1.5959823546008813;-0.035308111643317541 -0.089298708972382831 0.1374145122646997;-0.33015290424273075 -0.82448495070364647 -0.034906321483288809;0.060136002302050635 0.37969081710528257 0.15224668451369483;0.046264339087428136 0.13006437989015185 2.5596569863923211;-0.037978426975396044 -0.11217946368563353 10.907624482405501;0.22390436788406889 0.48892905478406529 -0.61914687182914552;-0.1073453550531572 -0.47561499102320648 -0.1636674694239279;-0.54752499556116263 -1.0637430044443033 -6.1535568446428961;0.41463222195707228 0.7929114106999422 0.39231417839160077;0.48391069304956297 0.92295156721830907 1.5224592167930635;-0.12331343922166922 -0.9451517592163049 -0.14092437429155447;0.039489367799054584 0.11028112194674694 2.8496340310447108;0.38935497005075553 0.77607196439985171 0.78490703215665869;-0.035042994245012463 -0.1074794379228091 -11.202912028457011;0.13092302543177867 0.11626178541212248 2.2262493393973877;-0.14074237026160252 -1.2917701043503873 -0.21304627183735009;-0.10050441529026051 -0.79326365249268316 0.24988243522247269;-0.47242112046447376 -0.86064352587871396 4.6631027067557191;-0.50277696097198177 -0.91318994936012721 2.8977483789185046;-0.15691619496190617 -0.50696175329207649 -1.6520151594200378;0.020997802808103185 0.2709196410110728 -0.22308706359931724;-0.080014226630529553 -0.24614916036341711 -1.2915353046107423;0.35587970458951879 0.66515571890120995 -0.74333835479882648;0.13404355305732715 0.396139133215832 0.095191153338670564;0.33945747222105516 0.63676978139754892 -0.31830433053254936;-0.14538474513828575 0.31244855316028725 -0.013132815515482638;-0.13604787366759938 -0.66050302254107096 -0.2695055432615574;0.043824609313487008 0.1259177986804913 -8.2564544043099897;0.017418547317891386 0.079240087053973882 -6.1552571393274906;0.051484984836642572 0.059913881218220617 1.1440969111855641;0.12165895814813704 0.0064594245055494331 -0.53527263526829039;-0.19770246629284879 0.0060300518827019478 -0.58868323065312855;-0.041796979204889513 -0.12313858572037265 -8.6874944116854511;0.44122370682031403 0.76140538939928171 -0.25670190770866513;0.16921151033402715 0.48133060098319186 0.060732934178038371;-0.028832921865565693 -0.073905012124322975 2.8499423707196501;0.21262759682022736 -0.011017784445552127 0.49803590346808702;-0.039373361445880981 0.37300766579776123 0.21348707795584967;0.14434981962769877 0.32832232938428535 -1.8648030213626132;0.13096866039755264 -0.14106092451286817 1.2865442054253138;0.22913563181185767 0.48389153990986428 -2.9206354061903332;0.06961542457943995 0.1455720375724002 -0.22255353132654179;-0.090881548537602802 -0.29683209671120891 1.3041736629540279;0.26966503782535151 0.60593681099024688 -1.07335342504788;-0.52633089001920186 -0.94667452920083739 1.7652106382108621];

% Layer 2
b2 = [1.2807592858090435;-0.089395149707864871;0.027337271263609297];
LW2_1 = [-1.7112825792441826 -0.86540920884162698 -3.9101427012111376 -1.5079279337876854 -0.41106897298216544 0.51512300396751531 1.1077557299716478 -0.28387890722535197 4.3931512273024342 2.6506894484536376 0.095488090788833677 0.19954061149203106 -3.1348552953689897 1.3320919793901904 1.7635256214151518 -0.75251964229489077 -3.4017343004504026 -0.53463749991386222 2.7466714893373099 -2.3379397882261141 -0.33118507142303932 0.45190639914464359 1.7049380088724784 -5.1086137540504319 0.41627382822505604 -0.42600244076133187 1.530761128470886 1.8417479011998943 -0.21544324301397863 -0.29090298914650986 -0.37027677551463634 1.4525980254666293 8.0296024812309241 0.53623111988029259 2.668685989959048 -0.98560022970967121 0.9927248826979258 -7.834766432831632 -1.308062052066153 -0.29535645879631695 2.6309672050467583 -0.6598437096729235 -0.39733061871742076 -2.9327726173271733 -0.14658516346601383 -3.6023467744960564 -0.5202339066629319 -0.80822694331869083 -0.57147284624685613 -0.85555790231721607;2.1644487675367756 0.82906364785666009 1.6569871541120924 0.99706303085631509 1.0816094371413842 -0.18080243480567917 -0.38446185010218903 -0.20436290977979105 -2.0413053468181586 -0.18482336194587812 0.15763994918852187 0.38578100795551462 -0.74704294011611161 -0.33948550177427611 -0.2325154495690786 0.11749088758433711 1.5799350020138359 0.22494244100440949 -0.21966619800709419 -1.8750989968776304 0.14307151037213769 0.02604258338884647 0.35737245961792413 -0.19349739630548199 -1.3149494704186748 0.19756785322043258 -0.28699113142141164 -0.094584796524703876 -0.36970591428622873 0.0027781758140510335 -0.093161234648834926 -1.5422634172686587 -1.1771457732208863 -0.71680949442979414 -0.98220480708681812 0.5745846397410016 -0.25320942008352676 1.1147965341906851 0.043591002213737441 -0.45895836120457612 -0.95341870148069852 -0.21442946341935745 -0.18221705181016321 1.433794104023578 -0.2199391387612637 1.2284471411845492 0.14951539019568422 -0.40223202543956094 0.52505763865112764 -0.11219784867313363;1.379840542899812 -3.6368848471625408 -3.4225737973107249 -0.80547985061586791 1.5869737949945839 0.29118923837472577 0.23783581125528433 -0.62013309004568973 3.6738450197576098 -1.8793131728854058 -0.98148444356636722 0.65644381306919142 -4.2359675463951003 0.64086238567116427 1.7545809521178939 -0.67142825299297115 2.6654906482034328 -0.25343496132326176 -1.730818709816579 -6.8721300824826574 -0.23635784108277796 0.5387185397586538 2.26307226683846 -4.8239807561049988 -1.4628874300311525 -0.78995799701336722 1.8494463937769507 0.81018153145806981 -0.75544299897122547 -1.2657300982604118 -0.31844319504978003 -0.37429253291032644 -1.5287632155016493 3.1969531880765296 1.2922179711694879 -0.20830710313912629 -0.27301446434239873 1.4169000008988695 -0.97362419798858102 -0.92621566741675487 -3.1277595217049297 -0.55597813520604589 -0.80733312952634262 -1.5594305614736195 -1.0601881502263513 -2.4482167012442311 -0.56573343939974541 -2.8630401268419994 0.092526197903776072 -0.80700168199538669];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.195280495352941;4.82359443461016;1.88604057881778];
y1_step1.xoffset = [-5.12083912012128;-0.207314278502525;-0.530211285605968];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = removeconstantrows_apply(x1,x1_step1);
xp1 = mapminmax_apply(xp1,x1_step2);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
  y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
