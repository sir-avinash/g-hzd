function [y1] = nnOrbit(x1)
%NNORBIT neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 24-Jul-2017 00:46:25.
% 
% [y1] = nnOrbit(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 3xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-3.50994426205878;-2.01712067292452;0;0];
x1_step1.gain = [0.285500318306702;0.393105940244728;1.0126582278481;2.5];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.479447493436119;18.132790493176476;-6.2782713038709597;2.5336990718966224;-7.2141624094628671;-3.1417291849870934;2.8942596304129302;0.43304860321019445;0.38115312750042518;0.84208896487077045;-1.6383787907898835;2.4546939405142396;-1.3358366457776298;-1.4337921259517901;0.50012695221984094;-0.30710400958053397;2.9921413414940572;0.60038311851923576;-0.81442509463355184;5.3434656716589348;1.8466498743012485;-0.44288146026108866;2.1186137566724978;0.0019369381360929405;-4.6574739757012331;-0.73889836237059359;0.58936340335973714;6.9328395199469073;7.8052926366732516;-0.88653146987464704;0.49178103898770553;4.5408977627711735;0.0092078257879882001;2.0217303202545116;1.342283403866573;3.5716344729126264;3.5314464233257441;4.6703232649895554;-0.17871728946122153;-2.970595251653728;-1.7004482414944599;-4.8175364720537281;20.256792932087315;8.9551086336433681;-6.1441808556265736;-6.4340514452455562;-8.1362255032643809;6.6457660175931128;3.6734034487884748;1.3738777868716869];
IW1_1 = [0.12341179633321087 0.13810952972657298 3.647524263078878 0.3036064942059804;0.066981717585663042 0.079638856551322176 18.038478593872405 -0.035752811971481356;0.24630371222295533 0.26873820079080574 4.9356921275462486 -0.098614752854820367;-0.14623991853233731 -0.12477567125262176 2.8383342973420125 0.17402866934821898;-0.058371695882133569 -0.06266227040577925 -7.4446031592267738 0.025853310930926805;-0.099408206446692279 -0.11442258421508091 2.1558107359877292 0.45495800398353364;-0.049231944514916019 -0.053770352380649027 -2.7416781641366454 -0.068791877316292563;-0.58711922130449079 -0.18449579186267395 1.0508173848274982 0.32266008323378736;-0.46225287603198323 -0.1345147336220491 1.144197003621882 0.27619090216678832;-0.034607684751994036 -0.072391939913751854 -2.4567324707432454 0.0014332916512690573;-0.23548301942234681 -0.41081889314499143 -0.61553022517273959 -0.308611028858162;0.20941567400551253 0.18075151371794917 3.8365762471744218 -0.22831072409019776;0.025656349501721933 0.044886420719859071 -1.8064783953864945 -0.040197846007068355;-0.80041580459352601 -0.26269675014803862 -1.5711169081027985 0.20059472893122221;-0.097038729406014865 -0.17940388247443506 0.71144412280201974 -0.24567020396889516;-0.035592494865169584 -0.0013159153264326354 2.6035200190606536 -0.19544680671951839;-0.24311755959928588 -0.32901422552797255 -2.9503826337870636 0.089060408224494694;0.33848071237692973 0.070664394784435092 -1.7733632110379256 -0.15840754331347312;-0.96433945935442844 -0.31350900094702949 -0.76758685441197894 0.3483163722121515;5.4632585908769338 1.6928533663924294 3.1927172894888143 -1.8358404150995218;-0.003676290474441085 -0.083079379137436307 2.950829811860066 0.1392061015935474;0.12076737969560547 0.1440635581908736 0.76409031227115864 -0.0042922681204307644;0.9962837339167967 0.16793988921194952 2.6263113828931668 -0.18740669437065696;0.24807825646775142 0.51993431110843469 0.20661657649624077 0.34841266611210758;-4.3662590705545412 -1.6864488173427479 -1.607946892013439 1.5341484521918467;-0.84020668951175603 -0.27027400704908788 -0.93194657793413038 0.2744496215749283;-0.0058469803026865094 0.00047329544382192608 1.7509761662347281 -0.12189884158827501;-0.0048605656553663643 -0.062427945157026966 6.9587174467243313 0.0062811465046143213;6.9380465065100658 1.4283393923172227 5.6512505668360351 -2.2137458860043755;0.0072449022354952493 0.0037996966419257604 -2.4927146584014781 0.23736476147387772;0.89723117763030913 0.29362124001753698 1.1949069523763896 -0.27386307589632181;0.05320088342209732 0.094295144466145356 3.9059394774200342 -0.04720396320421575;0.11282550905528184 0.076150760502640219 -1.3187228206746218 -0.16577749197384639;0.75889249790135527 0.15475297097728169 2.3602942903798163 -0.12051055850667911;0.2427726614122272 0.57498667444251406 -1.5993991898243587 0.11723359038641966;2.8521045122530291 0.5749047061546827 3.7164471064600533 -0.82316928972580194;2.9320238409419312 0.5886150454815493 3.6906141956731395 -0.85633933939589668;4.3170832449462599 1.774931278333413 1.4140560741054735 -1.5226348516806112;-0.040614511941675958 -0.044937314808389098 1.8922971585076029 -0.16536070236794048;0.040930047202179451 -0.094282412995006504 -3.2782399300882563 -0.11653876317094929;0.046723712522448148 0.01662757641005088 2.6509984551588071 0.13161264158134273;-4.4435905730537666 -0.79029838774466921 -1.8920353638869234 1.6235310269497341;0.0021949003944243617 -0.049971833217257754 20.26142976556206 -0.014051450736810345;7.9514336197168571 2.8951490474253925 4.2846033920803368 -2.6775483530480102;-0.28188161341395929 -0.45751791050181634 4.6571762829457635 0.084614852300993831;-6.2525576349349699 -1.4303747497924706 -4.3432252770408377 2.0600843658523726;-5.0872416283037083 -3.4633072296695437 -1.1508784495113513 1.6434046325916787;4.0631338935448689 2.6942337218854862 1.2031427970209172 -1.3251046536638704;0.02689972391729447 0.025562382174517874 -2.7205485977849255 -0.33841874778390485;0.13150366846772815 0.30076592803466079 -1.3459834090076086 0.19804314571551948];

% Layer 2
b2 = [-2.3981878932227407;1.4216429476174866;3.3671922884679173];
LW2_1 = [1.0334395650955628 1.7959306930629118 4.8396871945900193 0.48916766626777497 -2.4219142554634581 1.1010750812275854 -0.18053214788132205 1.3964078107681634 -2.4017931415376168 -1.3966962179076032 0.65762417871647361 -0.134737340311438 5.9402094879359426 2.4725625749024638 -0.51821879906654189 1.4603618015845052 -1.016603055833627 0.24896650658700442 0.96373880263187328 -0.1748798780843315 0.9201409824656489 -5.4006366952175791 -1.5504338507650102 -0.1282307532363321 -1.2102103354058578 -3.2576754610274672 8.0753809597689497 -3.3108561099767178 -0.13041671685167514 1.4874318034034235 -1.1606838881413517 -0.97875693026405597 -1.5373428497752033 3.5173172874304495 -0.42011255933483005 -1.0420677336034641 0.94018565605297644 -1.0628082302127184 -3.8435581866129702 -0.79267439598021172 0.92274574969592282 0.064055932365822743 -1.2379465013766409 -0.1542778471057098 -5.8185895155283287 -0.22284970491155137 1.1387648717268966 1.7927915855271672 2.3427854199936542 1.4366038865236432;-1.5624300620149161 0.24757254879245327 -1.7694810786288617 -0.030796586149086178 0.29485791967386998 -1.6035762965455609 -0.30686763122215671 -1.883607277552162 3.0732728404808869 1.0566594143544816 -1.1658697810942171 -0.083197734105637078 -6.5230027070811234 -1.5177608716694064 1.0237715713800031 -0.7795156806773933 1.4168225623750794 -0.19218552744274117 0.075782835001753299 0.064530614587974738 -1.4002115629701777 4.8730261107872819 1.5146356528211637 0.39897271708964599 0.063000881661659791 0.90990178989399551 -6.4717420279850773 0.78185902349446912 0.10985274784815527 -0.99735639840497992 0.48588805068334728 -1.1614297973927501 1.9832499438837734 -3.0843346310896131 0.84329534859014044 0.60698055752015767 -0.52915096272753559 -0.047462739505867983 1.9927517454102792 0.79475889516991327 -0.93005289192126772 -0.086850322520923534 -0.19267550320880539 0.052956077757508567 0.30077994517321649 0.135145367659989 0.35872457289651538 0.23505290367485848 -3.3178216696343465 -2.4023858626466641;-0.25397959644923696 -0.4393054722261599 2.7321014881958239 -1.6240047539653497 -1.934885975970055 -0.8429001479723145 -4.9393056686226373 0.074601393695304885 0.09885120470630418 -0.70239337726806006 -0.068308825835419293 -0.36516660713380522 -0.12970640795892929 -0.66527757069605131 -1.1496060672380413 0.033599368225036064 2.999279054324786 -0.029904410528070222 -1.0247386826315279 0.00070954325413350795 0.29964029460205216 -2.0289034559574453 -0.26848005446058221 -0.10125281066890253 0.26038347121766026 2.3921596042358564 1.0926797220771638 -0.47684724885717056 -0.039294997744989742 0.34401222824353972 0.64256609983352364 -9.0647904900776055 2.7482135386647926 0.77109781461762494 -0.86950097402691107 0.54794098852297968 -0.56496578274599751 0.3354855776775722 1.5805831211402681 -2.8473501961791308 0.64034300138566813 0.036810961869647232 0.80376570291012794 0.03383267370715088 -6.5388858679563882 -0.0086246846565410252 -1.0489531101108684 -1.3857781469150081 -0.50947220291243878 1.3627426088846342];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0566713213169771;1.76360803874581;0.599182701269643];
y1_step1.xoffset = [-19.0449930931949;-0.53361929275394;-1.53682859858942];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
