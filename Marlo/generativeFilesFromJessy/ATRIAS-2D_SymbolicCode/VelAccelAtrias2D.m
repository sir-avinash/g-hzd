function [vcm J_cm dJ_cm] =  VelAccelAtrias2D(q,dq)
%%%%%%  VelAccelAtrias2D.m
%%%%  06-Apr-2015 12:45:58
%%%%
%%%% Authors(s): Grizzle
%%%%
%%%%
[g mTotal L1 L2 L3 L4 m1 m2 m3 m4 Jcm1 Jcm2 Jcm3 Jcm4 ellzcm1 ...
         ellzcm2 ellzcm3 ellzcm4 ellycm1 ellycm2 ellycm3 ellycm4 LT mT ...
         JcmT ellzcmT ellycmT mH JcmH K1 K2 Kd1 Kd2 Jrotor1 Jrotor2 ...
         Jgear1  Jgear2 R1  R2] = modelParametersAtrias_v05;
%%%%
%%%%[g mTotal L1 L2 L3 L4 m1 m2 m3 m4 Jcm1 Jcm2 Jcm3 Jcm4 ellzcm1 ellzcm2 ellzcm3 ellzcm4 ellycm1 ellycm2 ellycm3 ellycm4 LT mT JcmT ellzcmT ellycmT mH JcmH K1 K2 Kd1 Kd2 Jrotor1 Jrotor2 Jgear1  Jgear2 R1  R2] = modelParametersAtrias_v05;
%%%%
%%%%
yH=q(1);  dyH=dq(1);
zH=q(2);  dzH=dq(2);
qT=q(3);  dqT=dq(3);
q1=q(4);  dq1=dq(4);
q2=q(5);  dq2=dq(5);
q1L=q(6);  dq1L=dq(6);
q2L=q(7);  dq2L=dq(7);
%%%%
%%%%
vcm=zeros(2,1);
vcm(1,1)=-(-2*m1-2*m2-2*m3-2*m4-mT-mH)/(mT+mH+2*m1+2*m2+2*m3+2*...
         m4)*dyH-(L1*cos(qT+q1L)*m3+L1*cos(qT+q1)*m3+L2*cos(qT+q2L)*m4+L2*...
         cos(qT+q2)*m4+cos(qT+q2L)*ellzcm2*m2+cos(qT+q2L)*ellzcm3*...
         m3+sin(qT+q2L)*ellycm2*m2+sin(qT+q2L)*ellycm3*m3+cos(qT+q1L)*...
         ellzcm1*m1+cos(qT+q1L)*ellzcm4*m4+sin(qT+q1L)*ellycm1*...
         m1+sin(qT+q1L)*ellycm4*m4+cos(qT)*ellzcmT*mT+sin(qT)*ellycmT*...
         mT+cos(qT+q2)*ellzcm2*m2+cos(qT+q2)*ellzcm3*m3+sin(qT+q2)*...
         ellycm2*m2+sin(qT+q2)*ellycm3*m3+cos(qT+q1)*ellzcm1*...
         m1+cos(qT+q1)*ellzcm4*m4+sin(qT+q1)*ellycm1*m1+sin(qT+q1)*...
         ellycm4*m4)/(mT+mH+2*m1+2*m2+2*m3+2*m4)*dqT-(L1*cos(qT+q1)*...
         m3+sin(qT+q1)*ellycm1*m1+sin(qT+q1)*ellycm4*m4+cos(qT+q1)*...
         ellzcm1*m1+cos(qT+q1)*ellzcm4*m4)/(mT+mH+2*m1+2*m2+2*m3+2*m4)*...
         dq1-(L2*cos(qT+q2)*m4+sin(qT+q2)*ellycm2*m2+sin(qT+q2)*ellycm3*...
         m3+cos(qT+q2)*ellzcm2*m2+cos(qT+q2)*ellzcm3*m3)/(mT+mH+2*m1+2*...
         m2+2*m3+2*m4)*dq2-(L1*cos(qT+q1L)*m3+sin(qT+q1L)*ellycm1*...
         m1+sin(qT+q1L)*ellycm4*m4+cos(qT+q1L)*ellzcm1*m1+cos(qT+q1L)*...
         ellzcm4*m4)/(mT+mH+2*m1+2*m2+2*m3+2*m4)*dq1L-(L2*cos(qT+q2L)*...
         m4+sin(qT+q2L)*ellycm2*m2+sin(qT+q2L)*ellycm3*m3+cos(qT+q2L)*...
         ellzcm2*m2+cos(qT+q2L)*ellzcm3*m3)/(mT+mH+2*m1+2*m2+2*m3+2*m4)*...
         dq2L;
vcm(2,1)=dzH+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*sin(qT+q2L)*...
         m4-sin(qT+q1L)*ellzcm4*m4+cos(qT+q1L)*ellycm4*m4-L1*sin(qT+q1L)*...
         m3-sin(qT+q2L)*ellzcm3*m3+cos(qT+q2L)*ellycm3*m3-sin(qT+q2L)*...
         ellzcm2*m2+cos(qT+q2L)*ellycm2*m2-sin(qT+q1L)*ellzcm1*...
         m1+cos(qT+q1L)*ellycm1*m1-L2*sin(qT+q2)*m4-sin(qT+q1)*ellzcm4*...
         m4+cos(qT+q1)*ellycm4*m4-L1*sin(qT+q1)*m3-sin(qT+q2)*ellzcm3*...
         m3+cos(qT+q2)*ellycm3*m3-sin(qT+q2)*ellzcm2*m2+cos(qT+q2)*...
         ellycm2*m2-sin(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellycm1*m1-sin(qT)*...
         ellzcmT*mT+cos(qT)*ellycmT*mT)*dqT+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*...
         (-sin(qT+q1)*ellzcm4*m4+cos(qT+q1)*ellycm4*m4-L1*sin(qT+q1)*...
         m3-sin(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellycm1*m1)*dq1+1/(mT+mH+2*...
         m1+2*m2+2*m3+2*m4)*(-L2*sin(qT+q2)*m4-sin(qT+q2)*ellzcm3*...
         m3+cos(qT+q2)*ellycm3*m3-sin(qT+q2)*ellzcm2*m2+cos(qT+q2)*...
         ellycm2*m2)*dq2+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-sin(qT+q1L)*...
         ellzcm4*m4+cos(qT+q1L)*ellycm4*m4-L1*sin(qT+q1L)*m3-sin(qT+q1L)*...
         ellzcm1*m1+cos(qT+q1L)*ellycm1*m1)*dq1L+1/(mT+mH+2*m1+2*m2+2*...
         m3+2*m4)*(-L2*sin(qT+q2L)*m4-sin(qT+q2L)*ellzcm3*m3+cos(qT+q2L)*...
         ellycm3*m3-sin(qT+q2L)*ellzcm2*m2+cos(qT+q2L)*ellycm2*m2)*dq2L;
J_cm=zeros(2,7);
J_cm(1,1)=-(-2*m1-2*m2-2*m3-2*m4-mT-mH)/(mT+mH+2*m1+2*m2+2*m3+2*...
         m4);
J_cm(1,3)=-(L1*cos(qT+q1L)*m3+L1*cos(qT+q1)*m3+L2*cos(qT+q2L)*...
         m4+L2*cos(qT+q2)*m4+cos(qT+q2L)*ellzcm2*m2+cos(qT+q2L)*ellzcm3*...
         m3+sin(qT+q2L)*ellycm2*m2+sin(qT+q2L)*ellycm3*m3+cos(qT+q1L)*...
         ellzcm1*m1+cos(qT+q1L)*ellzcm4*m4+sin(qT+q1L)*ellycm1*...
         m1+sin(qT+q1L)*ellycm4*m4+cos(qT)*ellzcmT*mT+sin(qT)*ellycmT*...
         mT+cos(qT+q2)*ellzcm2*m2+cos(qT+q2)*ellzcm3*m3+sin(qT+q2)*...
         ellycm2*m2+sin(qT+q2)*ellycm3*m3+cos(qT+q1)*ellzcm1*...
         m1+cos(qT+q1)*ellzcm4*m4+sin(qT+q1)*ellycm1*m1+sin(qT+q1)*...
         ellycm4*m4)/(mT+mH+2*m1+2*m2+2*m3+2*m4);
J_cm(1,4)=-(L1*cos(qT+q1)*m3+sin(qT+q1)*ellycm1*m1+sin(qT+q1)*...
         ellycm4*m4+cos(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellzcm4*m4)/(mT+mH+2*...
         m1+2*m2+2*m3+2*m4);
J_cm(1,5)=-(L2*cos(qT+q2)*m4+sin(qT+q2)*ellycm2*m2+sin(qT+q2)*...
         ellycm3*m3+cos(qT+q2)*ellzcm2*m2+cos(qT+q2)*ellzcm3*m3)/(mT+mH+2*...
         m1+2*m2+2*m3+2*m4);
J_cm(1,6)=-(L1*cos(qT+q1L)*m3+sin(qT+q1L)*ellycm1*m1+sin(qT+q1L)*...
         ellycm4*m4+cos(qT+q1L)*ellzcm1*m1+cos(qT+q1L)*ellzcm4*...
         m4)/(mT+mH+2*m1+2*m2+2*m3+2*m4);
J_cm(1,7)=-(L2*cos(qT+q2L)*m4+sin(qT+q2L)*ellycm2*m2+sin(qT+q2L)*...
         ellycm3*m3+cos(qT+q2L)*ellzcm2*m2+cos(qT+q2L)*ellzcm3*...
         m3)/(mT+mH+2*m1+2*m2+2*m3+2*m4);
J_cm(2,2)=1;
J_cm(2,3)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*sin(qT+q2L)*...
         m4-sin(qT+q1L)*ellzcm4*m4+cos(qT+q1L)*ellycm4*m4-L1*sin(qT+q1L)*...
         m3-sin(qT+q2L)*ellzcm3*m3+cos(qT+q2L)*ellycm3*m3-sin(qT+q2L)*...
         ellzcm2*m2+cos(qT+q2L)*ellycm2*m2-sin(qT+q1L)*ellzcm1*...
         m1+cos(qT+q1L)*ellycm1*m1-L2*sin(qT+q2)*m4-sin(qT+q1)*ellzcm4*...
         m4+cos(qT+q1)*ellycm4*m4-L1*sin(qT+q1)*m3-sin(qT+q2)*ellzcm3*...
         m3+cos(qT+q2)*ellycm3*m3-sin(qT+q2)*ellzcm2*m2+cos(qT+q2)*...
         ellycm2*m2-sin(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellycm1*m1-sin(qT)*...
         ellzcmT*mT+cos(qT)*ellycmT*mT);
J_cm(2,4)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-sin(qT+q1)*ellzcm4*...
         m4+cos(qT+q1)*ellycm4*m4-L1*sin(qT+q1)*m3-sin(qT+q1)*ellzcm1*...
         m1+cos(qT+q1)*ellycm1*m1);
J_cm(2,5)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*sin(qT+q2)*...
         m4-sin(qT+q2)*ellzcm3*m3+cos(qT+q2)*ellycm3*m3-sin(qT+q2)*...
         ellzcm2*m2+cos(qT+q2)*ellycm2*m2);
J_cm(2,6)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-sin(qT+q1L)*ellzcm4*...
         m4+cos(qT+q1L)*ellycm4*m4-L1*sin(qT+q1L)*m3-sin(qT+q1L)*ellzcm1*...
         m1+cos(qT+q1L)*ellycm1*m1);
J_cm(2,7)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*sin(qT+q2L)*...
         m4-sin(qT+q2L)*ellzcm3*m3+cos(qT+q2L)*ellycm3*m3-sin(qT+q2L)*...
         ellzcm2*m2+cos(qT+q2L)*ellycm2*m2);
dJ_cm=zeros(2,7);
dJ_cm(1,3)=-1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*sin(qT+q2L)*...
         m4-sin(qT+q1L)*ellzcm4*m4+cos(qT+q1L)*ellycm4*m4-L1*sin(qT+q1L)*...
         m3-sin(qT+q2L)*ellzcm3*m3+cos(qT+q2L)*ellycm3*m3-sin(qT+q2L)*...
         ellzcm2*m2+cos(qT+q2L)*ellycm2*m2-sin(qT+q1L)*ellzcm1*...
         m1+cos(qT+q1L)*ellycm1*m1-L2*sin(qT+q2)*m4-sin(qT+q1)*ellzcm4*...
         m4+cos(qT+q1)*ellycm4*m4-L1*sin(qT+q1)*m3-sin(qT+q2)*ellzcm3*...
         m3+cos(qT+q2)*ellycm3*m3-sin(qT+q2)*ellzcm2*m2+cos(qT+q2)*...
         ellycm2*m2-sin(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellycm1*m1-sin(qT)*...
         ellzcmT*mT+cos(qT)*ellycmT*mT)*dqT-1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*...
         (-sin(qT+q1)*ellzcm4*m4+cos(qT+q1)*ellycm4*m4-L1*sin(qT+q1)*...
         m3-sin(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellycm1*m1)*dq1-1/(mT+mH+2*...
         m1+2*m2+2*m3+2*m4)*(-L2*sin(qT+q2)*m4-sin(qT+q2)*ellzcm3*...
         m3+cos(qT+q2)*ellycm3*m3-sin(qT+q2)*ellzcm2*m2+cos(qT+q2)*...
         ellycm2*m2)*dq2-1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-sin(qT+q1L)*...
         ellzcm4*m4+cos(qT+q1L)*ellycm4*m4-L1*sin(qT+q1L)*m3-sin(qT+q1L)*...
         ellzcm1*m1+cos(qT+q1L)*ellycm1*m1)*dq1L-1/(mT+mH+2*m1+2*m2+2*...
         m3+2*m4)*(-L2*sin(qT+q2L)*m4-sin(qT+q2L)*ellzcm3*m3+cos(qT+q2L)*...
         ellycm3*m3-sin(qT+q2L)*ellzcm2*m2+cos(qT+q2L)*ellycm2*m2)*dq2L;
dJ_cm(1,4)=-(-sin(qT+q1)*ellzcm4*m4+cos(qT+q1)*ellycm4*m4-L1*...
         sin(qT+q1)*m3-sin(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellycm1*...
         m1)/(mT+mH+2*m1+2*m2+2*m3+2*m4)*dqT-1/(mT+mH+2*m1+2*m2+2*m3+2*...
         m4)*(-sin(qT+q1)*ellzcm4*m4+cos(qT+q1)*ellycm4*m4-L1*sin(qT+q1)*...
         m3-sin(qT+q1)*ellzcm1*m1+cos(qT+q1)*ellycm1*m1)*dq1;
dJ_cm(1,5)=-(-L2*sin(qT+q2)*m4-sin(qT+q2)*ellzcm3*m3+cos(qT+q2)*...
         ellycm3*m3-sin(qT+q2)*ellzcm2*m2+cos(qT+q2)*ellycm2*m2)/(mT+mH+2*...
         m1+2*m2+2*m3+2*m4)*dqT-1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*...
         sin(qT+q2)*m4-sin(qT+q2)*ellzcm3*m3+cos(qT+q2)*ellycm3*...
         m3-sin(qT+q2)*ellzcm2*m2+cos(qT+q2)*ellycm2*m2)*dq2;
dJ_cm(1,6)=-(-sin(qT+q1L)*ellzcm4*m4+cos(qT+q1L)*ellycm4*m4-L1*...
         sin(qT+q1L)*m3-sin(qT+q1L)*ellzcm1*m1+cos(qT+q1L)*ellycm1*...
         m1)/(mT+mH+2*m1+2*m2+2*m3+2*m4)*dqT-1/(mT+mH+2*m1+2*m2+2*m3+2*...
         m4)*(-sin(qT+q1L)*ellzcm4*m4+cos(qT+q1L)*ellycm4*m4-L1*...
         sin(qT+q1L)*m3-sin(qT+q1L)*ellzcm1*m1+cos(qT+q1L)*ellycm1*m1)*...
         dq1L;
dJ_cm(1,7)=-(-L2*sin(qT+q2L)*m4-sin(qT+q2L)*ellzcm3*...
         m3+cos(qT+q2L)*ellycm3*m3-sin(qT+q2L)*ellzcm2*m2+cos(qT+q2L)*...
         ellycm2*m2)/(mT+mH+2*m1+2*m2+2*m3+2*m4)*dqT-1/(mT+mH+2*m1+2*m2+2*...
         m3+2*m4)*(-L2*sin(qT+q2L)*m4-sin(qT+q2L)*ellzcm3*m3+cos(qT+q2L)*...
         ellycm3*m3-sin(qT+q2L)*ellzcm2*m2+cos(qT+q2L)*ellycm2*m2)*dq2L;
dJ_cm(2,3)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-cos(qT+q1)*ellzcm1*...
         m1-sin(qT)*ellycmT*mT-cos(qT)*ellzcmT*mT-L2*cos(qT+q2L)*...
         m4-sin(qT+q1L)*ellycm4*m4-cos(qT+q1L)*ellzcm4*m4-L1*cos(qT+q1L)*...
         m3-sin(qT+q2L)*ellycm3*m3-cos(qT+q2L)*ellzcm3*m3-sin(qT+q2L)*...
         ellycm2*m2-cos(qT+q2L)*ellzcm2*m2-sin(qT+q1L)*ellycm1*...
         m1-cos(qT+q1L)*ellzcm1*m1-L2*cos(qT+q2)*m4-sin(qT+q1)*ellycm4*...
         m4-cos(qT+q1)*ellzcm4*m4-L1*cos(qT+q1)*m3-sin(qT+q2)*ellycm3*...
         m3-cos(qT+q2)*ellzcm3*m3-sin(qT+q2)*ellycm2*m2-cos(qT+q2)*...
         ellzcm2*m2-sin(qT+q1)*ellycm1*m1)*dqT+1/(mT+mH+2*m1+2*m2+2*m3+2*...
         m4)*(-sin(qT+q1)*ellycm1*m1-sin(qT+q1)*ellycm4*m4-cos(qT+q1)*...
         ellzcm4*m4-L1*cos(qT+q1)*m3-cos(qT+q1)*ellzcm1*m1)*...
         dq1+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*cos(qT+q2)*m4-sin(qT+q2)*...
         ellycm3*m3-cos(qT+q2)*ellzcm3*m3-sin(qT+q2)*ellycm2*...
         m2-cos(qT+q2)*ellzcm2*m2)*dq2+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*...
         (-sin(qT+q1L)*ellycm4*m4-cos(qT+q1L)*ellzcm4*m4-L1*cos(qT+q1L)*...
         m3-sin(qT+q1L)*ellycm1*m1-cos(qT+q1L)*ellzcm1*m1)*...
         dq1L+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*cos(qT+q2L)*...
         m4-sin(qT+q2L)*ellycm3*m3-cos(qT+q2L)*ellzcm3*m3-sin(qT+q2L)*...
         ellycm2*m2-cos(qT+q2L)*ellzcm2*m2)*dq2L;
dJ_cm(2,4)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-sin(qT+q1)*ellycm1*...
         m1-sin(qT+q1)*ellycm4*m4-cos(qT+q1)*ellzcm4*m4-L1*cos(qT+q1)*...
         m3-cos(qT+q1)*ellzcm1*m1)*dqT+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*...
         (-sin(qT+q1)*ellycm1*m1-sin(qT+q1)*ellycm4*m4-cos(qT+q1)*ellzcm4*...
         m4-L1*cos(qT+q1)*m3-cos(qT+q1)*ellzcm1*m1)*dq1;
dJ_cm(2,5)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*cos(qT+q2)*...
         m4-sin(qT+q2)*ellycm3*m3-cos(qT+q2)*ellzcm3*m3-sin(qT+q2)*...
         ellycm2*m2-cos(qT+q2)*ellzcm2*m2)*dqT+1/(mT+mH+2*m1+2*m2+2*m3+2*...
         m4)*(-L2*cos(qT+q2)*m4-sin(qT+q2)*ellycm3*m3-cos(qT+q2)*ellzcm3*...
         m3-sin(qT+q2)*ellycm2*m2-cos(qT+q2)*ellzcm2*m2)*dq2;
dJ_cm(2,6)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-sin(qT+q1L)*ellycm4*...
         m4-cos(qT+q1L)*ellzcm4*m4-L1*cos(qT+q1L)*m3-sin(qT+q1L)*ellycm1*...
         m1-cos(qT+q1L)*ellzcm1*m1)*dqT+1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*...
         (-sin(qT+q1L)*ellycm4*m4-cos(qT+q1L)*ellzcm4*m4-L1*cos(qT+q1L)*...
         m3-sin(qT+q1L)*ellycm1*m1-cos(qT+q1L)*ellzcm1*m1)*dq1L;
dJ_cm(2,7)=1/(mT+mH+2*m1+2*m2+2*m3+2*m4)*(-L2*cos(qT+q2L)*...
         m4-sin(qT+q2L)*ellycm3*m3-cos(qT+q2L)*ellzcm3*m3-sin(qT+q2L)*...
         ellycm2*m2-cos(qT+q2L)*ellzcm2*m2)*dqT+1/(mT+mH+2*m1+2*m2+2*m3+2*...
         m4)*(-L2*cos(qT+q2L)*m4-sin(qT+q2L)*ellycm3*m3-cos(qT+q2L)*...
         ellzcm3*m3-sin(qT+q2L)*ellycm2*m2-cos(qT+q2L)*ellzcm2*m2)*dq2L;
%%%%
%%%%
return